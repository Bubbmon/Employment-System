(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["myChat"],{"0120":function(e,t,s){},"034d":function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"test"},[s("HeaderHR"),s("div",{staticClass:"chatbox"},[s("div",{staticClass:"message"},e._l(e.messageList,(function(t,n){return s("div",{key:n,staticClass:"item"},[s("div",[e._v(e._s(t.from)+" "+e._s(t.msg))])])})),0),s("div",{staticClass:"inputbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.newMessage,expression:"newMessage"}],attrs:{type:"text"},domProps:{value:e.newMessage},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.send.apply(null,arguments)},input:function(t){t.target.composing||(e.newMessage=t.target.value)}}}),s("button",{on:{click:e.send}},[e._v("send")])])])],1)},i=[],o=s("2c4f"),a={name:"test",components:{HeaderHR:o["a"]},data:function(){return{webSocketObj:null,wsHeartflag:!1,reconnectTime:0,message:null,newMessage:"",messageList:[],talkerId:decodeURI(this.$route.query.hrId)}},created:function(){this.initWebSocket()},destroyed:function(){},methods:{send:function(){var e=this;this.messageList.push({from:"我",msg:this.newMessage}),this.newMessage=encodeURIComponent(this.newMessage),this.$http({method:"post",url:"http://1.117.44.227:8088/employment/talk/talkTo",headers:{token:this.$store.state.token.value,id:this.talkerId,message:this.newMessage}}).then((function(t){e.newMessage="",console.log(t.data)}))},initWebSocket:function(){this.webSocketObj=new WebSocket("ws://1.117.44.227:8088/employment/webSocket"),this.webSocketObj.onopen=this.onOpen,this.webSocketObj.onmessage=this.onMessage,this.webSocketObj.onerror=this.onError,this.webSocketObj.onclose=this.onClose},onOpen:function(){this.wsHeartflag=!0,this.webSocketObj.send("#open#"+this.$store.state.token.value),this.reconnectTime=0},timingHeart:function(){var e=this;this.wsHeartflag&&this.webSocketObj.send("heartbeat-test"),this.wsHeart=setTimeout((function(){e.timingHeart()}),1e5)},onMessage:function(e){this.message=JSON.parse(e.data),console.log(this.message),this.talkerId=this.message.id,console.log(this.talkerId),this.messageList.push({from:this.message.id,msg:this.message.message})},onError:function(){var e=this;clearTimeout(this.wsHeart),this.wsHeartflag=!1,this.reconnectTime<=5?setTimeout((function(){e.onOpen(),e.reconnectTime+=1}),5e3):(this.$toast("抱歉，暂时无法连接到聊天服务器，请稍后再试"),this.onClose())},onClose:function(){this.webSocketObj.send("#close#"+this.$store.state.token.value),this.wsHeartflag=!1,this.webSocketObj&&this.webSocketObj.close&&this.webSocketObj.close()}}},c=a,r=(s("daf2"),s("2877")),l=Object(r["a"])(c,n,i,!1,null,"229ddc27",null);t["default"]=l.exports},"2c4f":function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"whole"},[s("div",{staticClass:"logo",on:{click:e.backToHome}}),s("div",{staticClass:"self-center",staticStyle:{width:"150px",height:"100%",float:"right",display:"flex"}},[s("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":e.activeIndex,mode:"horizontal"},on:{select:e.handleSelect}},[s("el-submenu",{attrs:{index:"1"}},[s("template",{slot:"title"},[e._v("个人中心")]),s("el-menu-item",{attrs:{index:"selfcenter"},on:{select:e.handleSelect}},[e._v("账户信息")]),s("el-menu-item",{attrs:{index:"issueResume"},on:{select:e.handleSelect}},[e._v("发布招聘信息")]),s("el-menu-item",{attrs:{index:"recruimentList"},on:{select:e.handleSelect}},[e._v("查看已发布的信息")]),s("el-menu-item",{attrs:{index:"chatListHR"},on:{select:e.handleSelect}},[e._v("我的聊天")])],2)],1)],1)])},i=[],o={data:function(){return{activeIndex:"1"}},methods:{handleSelect:function(e){"selfcenter"==e?this.$router.push("/selfCenterHR"):"issueResume"==e?this.$router.push("/issueRecruimentInfo"):"recruimentList"==e?this.$router.push("/recruimentList"):"chatListHR"==e&&this.$router.push("/chatListHR")},backToHome:function(){this.$router.push("/searchHR")}}},a=o,c=(s("6a81"),s("2877")),r=Object(c["a"])(a,n,i,!1,null,"0dae64fc",null);t["a"]=r.exports},"6a81":function(e,t,s){"use strict";s("0120")},daf2:function(e,t,s){"use strict";s("ec77")},ec77:function(e,t,s){}}]);
//# sourceMappingURL=myChat.1f2d7b97.js.map